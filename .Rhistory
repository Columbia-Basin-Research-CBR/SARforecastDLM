scale_x_continuous(breaks = seq(1964, 2024, 5)) +
theme_minimal()
)
plot_data
dat
dlm_3$states[i,]
Z[1,2,]
Z
# Create a data frame for plotting from model
plot_data <- data.frame(
years = years,
dat = t(dat),
fore_mean = fore_mean,
fore_var = fore_var
CUI_z = Z[1,2,]
# Create a data frame for plotting from model
plot_data <- data.frame(
years = years,
dat = t(dat),
fore_mean = fore_mean,
fore_var = fore_var,
CUI_z = Z[1,2,]
)
plot_data
View(plot_data)
View(CUI_z)
CUI_z
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = dat), color = ifelse(is.na(dat),"blue", "red")) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)")
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = dat), color = ifelse(is.na(dat),"blue", "red")) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)")
)
# Create a data frame for plotting from model
plot_data <- data.frame(
years = years, #years
sa.obs = t(dat), #observed sar data
fore_mean = fore_mean, #mean of forecast
fore_var = fore_var, #variance of forecast
CUI_z = Z[1,2,] #predictor variable
)
# Create a data frame for plotting from model
plot_data <- data.frame(
years = years, #years
sar.obs = t(dat), #observed sar data
fore_mean = fore_mean, #mean of forecast
fore_var = fore_var, #variance of forecast
CUI_z = Z[1,2,] #predictor variable
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = dat), color = ifelse(is.na(sar.obs),"blue", "red")) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)")
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = dat, color = dat), color = ifelse(is.na(sar.obs),"blue", "red")) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)")
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = dat, color = is.na(dat))) +
scale_color_manual(values = c("TRUE" = "blue", "FALSE" = "red")) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)")
)
plot_data
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs, color = is.na(sar.obs))) +
scale_color_manual(values = c("TRUE" = "blue", "FALSE" = "red")) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)")
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
annotate("rect", xmin = 2022, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_grey()
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
annotate("rect", xmin = 2022, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_light()
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_light()
)
# Create the plot
plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_light()
)
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_light()
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_minimal()
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_minimal() +
theme(axis.line = element_line(color = "black") )
p<-plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
# annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_minimal() +
theme(axis.line = element_line(color = "black") )
)
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2023, 2023, 2021),
y = c(-Inf, -Inf, Inf, Inf),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
y_range <- range(plot_data$sar.obs, na.rm = TRUE)
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2023, 2023, 2021),
y = c(y_range[1], y_range[1], y_range[2], y_range[2]),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
y_range
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2023, 2023, 2021),
y = c(-8, -8, -2, -2),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2023, 2023, 2021),
y = c(-8.3, -8.3, -2.2, -2.2),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2023, 2023, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
p<-plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 5)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
# annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_classic() +
theme(axis.line = element_line(color = "black") )
)
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
plotly::ggplotly(
ggplot(data = sar.pred, aes(x = year, y = round(logit.s,2))) +
geom_point() +
geom_line(aes(y = fore_mean), color = "red") +
geom_line(aes(y = fore_mean+2*sqrt(fore_var)), color = "red", linetype = "dashed") +
geom_line(aes(y = fore_mean-2*sqrt(fore_var)), color = "red", linetype = "dashed") +
labs(title = "Logit(SAR) 1964 to 2021",
x = "Year",
y = "Logit(SAR)") +
scale_x_continuous(breaks = seq(1964, 2024, 10)) +
theme_minimal()
)
p<-plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs)) +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 10)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
# annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_classic() +
theme(axis.line = element_line(color = "black") )
)
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
p<-plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs), color = "#b47747") +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 10)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)") +
# annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_classic() +
theme(axis.line = element_line(color = "black") )
)
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
# Create a data frame for line segments
line_data <- data.frame(
x = plot_data$years[-nrow(plot_data)],
xend = plot_data$years[-1],
y = plot_data$fore_mean[-nrow(plot_data)],
yend = plot_data$fore_mean[-1],
color = ifelse(is.na(plot_data$sar.obs[-nrow(plot_data)]), "Forecasted Logit(SAR)", "95% CI"),
linetype = ifelse(is.na(plot_data$sar.obs[-nrow(plot_data)]), "solid", "dashed")
)
# Create the ggplot
p <- ggplot() +
geom_segment(data = line_data, aes(x = x, xend = xend, y = y, yend = yend, color = color, linetype = linetype)) +
scale_color_manual(values = c("Forecasted Logit(SAR)" = "black", "95% CI" = "black")) +
scale_linetype_manual(values = c("Forecasted Logit(SAR)" = "solid", "95% CI" = "dashed")) +
geom_point(data = plot_data, aes(x = years, y = sar.obs, color = "Observed Data"), size = 3) +
scale_x_continuous(breaks = seq(1964, 2024, 10)) +
labs(x = "Year of ocean entry", y = "Logit(SAR)", color = "Legend") +
theme_classic() +
theme(axis.line = element_line(color = "black"))
# Convert to plotly
p_plotly <- ggplotly(p)
library(plotly)
# Convert to plotly
p_plotly <- ggplotly(p)
# Add rectangle
p_plotly <- p_plotly %>%
add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
# Convert to plotly
p_plotly <- ggplotly(p)
p_plotly
p<-plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs), color = "#b47747") +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 10)) +
scale_linetype_manual(values = c("solid", "dashed"),
breaks = c("Forecasted logit.sar", "95% CI")) +
labs(x = "Year of ocean entry",
y = "Logit(SAR)") +
# annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_classic() +
theme(axis.line = element_line(color = "black") )
)
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = TRUE,
type = "scatter",
mode = "none"
)
p_plotly
p<-plotly::ggplotly(
ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs), color = "#b47747") +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 10)) +
scale_linetype_manual(values = c("solid", "dashed"),
breaks = c("Forecasted logit.sar", "95% CI")) +
labs(x = "Year of ocean entry",
y = "Logit(SAR)") +
# annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_classic() +
theme(axis.line = element_line(color = "black"),legend.position = "right" )
)
# Add rectangle
p_plotly <- p %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
p<-ggplot(plot_data, aes(x = years)) +
geom_point(aes(y = sar.obs), color = "#b47747") +
geom_line(aes(y = fore_mean)) +
geom_line(aes(y = fore_mean + 2 * sqrt(fore_var)), linetype = "dashed") +
geom_line(aes(y = fore_mean - 2 * sqrt(fore_var)), linetype = "dashed") +
scale_x_continuous(breaks = seq(1964, 2024, 10)) +
scale_linetype_manual(values = c("solid", "dashed"),
breaks = c("Forecasted logit.sar", "95% CI")) +
labs(x = "Year of ocean entry",
y = "Logit(SAR)") +
# annotate("rect", xmin = 2021, xmax = 2023, ymin = -Inf, ymax = Inf, fill = "grey", alpha = 0.2) +
theme_classic() +
theme(axis.line = element_line(color = "black"))
p_plotly<-ggplotly(p)
# Add rectangle
p_plotly <- p_plotly %>%
plotly::add_trace(
x = c(2021, 2024, 2024, 2021),
y = c(-8.5, -8.5, -1.8, -1.8),
fill = "toself",
fillcolor = "grey",
line = list(width = 0),
opacity = 0.2,
showlegend = FALSE,
type = "scatter",
mode = "none"
)
p_plotly
line_data
